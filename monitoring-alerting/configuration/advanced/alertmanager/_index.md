Обычно нет необходимости напрямую редактировать пользовательский ресурс Alertmanager. В большинстве случаев вам нужно будет только отредактировать Receivers и Routes для настройки уведомлений.

При обновлении Receivers и Routes приложение мониторинга автоматически обновит пользовательский ресурс Alertmanager, чтобы он соответствовал этим изменениям.

В этом разделе предполагается, что вы знакомы с тем, как компоненты мониторинга работают вместе. Дополнительные сведения об Alertmanager см . [в этом разделе.](https://github.com/rancher/docs/tree/master/content/rancher/v2.6/en/monitoring-alerting/how-monitoring-works#3-how-alertmanager-works) 

# О пользовательском ресурсе Alertmanager

По умолчанию Rancher Monitoring развертывает один Alertmanager в кластере, который использует по умолчанию Alertmanager Config Secret.

Вы можете отредактировать пользовательский ресурс Alertmanager, если хотите воспользоваться расширенными параметрами, которые не отображаются в формах пользовательского интерфейса Rancher, например, возможностью создать древовидную структуру маршрутизации глубиной более двух уровней.

Также можно создать более одного Alertmanager в кластере, что может быть полезно, если вы хотите реализовать мониторинг на уровне пространства имен. В этом случае вы должны управлять настраиваемыми ресурсами Alertmanager, используя тот же базовый секрет конфигурации Alertmanager.

# Глубоко вложенные маршруты

Хотя пользовательский интерфейс Rancher поддерживает только два уровня дерева маршрутизации, вы можете настроить более глубоко вложенные структуры маршрутизации, отредактировав файл Alertmanager YAML.

# Несколько реплик Alertmanager

В рамках вариантов развертывания схемы вы можете увеличить количество реплик Alertmanager, развернутых в вашем кластере. Всеми репликами можно управлять с помощью одного и того же базового Alertmanager Config Secret.

Этот элемент следует обновлять или изменять в любое время, когда вы хотите:
-	Добавить новых уведомителей или получателей
-	Изменить оповещения, которые должны отправляться определенным уведомителям или получателям.
-	Изменить группу рассылаемых оповещений

По умолчанию вы можете либо предоставить существующий Alertmanager Config Secret (то есть любой Secret в пространстве имен cattle-monitoring-system), либо разрешить Rancher Monitoring развернуть Alertmanager Config Secret по умолчанию в вашем кластере.

По умолчанию Alertmanager Config Secret, созданный Rancher, никогда не будет изменен или удален при обновлении или удалении rancher-monitoring схемы. Это ограничение предотвращает потерю или перезапись пользователями своей конфигурации предупреждений при выполнении операций на схеме.

Дополнительные сведения о том, какие поля можно указать в Alertmanager Config Secret, см. [в документации Prometheus Alertmanager.](https://prometheus.io/docs/alerting/latest/alertmanager/)
Полную спецификацию файла конфигурации Alertmanager и того, что он принимает, можно найти [здесь.](https://prometheus.io/docs/alerting/latest/configuration/#configuration-file)
