Квоты ресурсов в Rancher включают в себя тот же функционал, что и [собственная версия Kubernetes](https://kubernetes.io/docs/concepts/policy/resource-quotas/)  
Однако в Rancher квоты ресурсов были расширены, чтобы вы могли применять их к проектам.

В стандартном развертывании Kubernetes квоты ресурсов применяются к отдельным пространствам имен. Однако вы не можете применить квоту к своим пространствам имен одновременно одним действием. Вместо этого квота ресурсов должна применяться несколько раз.

На следующей диаграмме администратор Kubernetes пытается применить квоту ресурсов без Rancher. Администратор хочет применить квоту ресурсов, которая устанавливает одинаковые ограничения CPU и памяти для каждого пространства имен в его кластере ( Namespace 1-4). Однако в базовой версии Kubernetes для каждого пространства имен требуется уникальная квота ресурсов. Администратор должен создать четыре разные квоты ресурсов с одинаковыми настроенными спецификациями ( Resource Quota 1-4) и применить их по отдельности.

![Kubernetes: уникальные квоты ресурсов применяются к каждому пространству имен ](https://github.com/rancher/docs/blob/master/content/rancher/v2.6/en/project-admin/resource-quotas/quotas-for-projects/%7B%7B%3Cbaseurl%3E%7D%7D/img/rancher/kubernetes-resource-quota.svg)

Квоты на ресурсы немного отличаются в Rancher. В Rancher вы применяете к проекту квоту ресурсов, а затем квота распространяется на каждое пространство имен, после чего Kubernetes применяет ваши ограничения, используя базовую версию квот ресурсов. Если вы хотите изменить квоту для определенного пространства имен, вы можете переопределить ее.

Квота ресурсов включает в себя два ограничения, которые вы устанавливаете при создании или редактировании проекта:
-	Ограничения проекта:
Этот набор значений настраивает общий лимит для каждого указанного ресурса, совместно используемого всеми пространствами имен в проекте.
-	Ограничения пространства имен по умолчанию:
Этот набор значений настраивает ограничение квоты по умолчанию, доступное для каждого пространства имен 
каждого указанного ресурса. Когда пространство имен создается в проекте без переопределений, это ограничение автоматически привязывается к пространству имен и применяется.

На следующей диаграмме администратор Rancher хочет применить квоту ресурсов, которая устанавливает одинаковый предел ЦП и памяти для каждого пространства имен в его проекте ( Namespace 1-4). Однако в Rancher администратор может установить квоту ресурсов для проекта ( Project Resource Quota), а не для отдельных пространств имен. Эта квота включает лимиты ресурсов как для всего проекта ( Project Limit), так и для отдельных пространств имен ( Namespace Default Limit). Затем Rancher распространяет Namespace Default Limit на каждое пространство имен ( Namespace Resource Quota) при создании.

![Rancher: квоты ресурсов распространяются на каждое пространство имен](https://github.com/rancher/docs/blob/master/content/rancher/v2.6/en/project-admin/resource-quotas/quotas-for-projects/%7B%7B%3Cbaseurl%3E%7D%7D/img/rancher/rancher-resource-quota.png)
 
 Давайте выделим еще несколько функциональных нюансов для пространств имен, созданных в пользовательском интерфейсе Rancher. Если квота удалена на уровне проекта, она также будет удалена из всех пространств имен, содержащихся в этом проекте, несмотря на любые существующие переопределения. Кроме того, обновление ограничения существующего пространства имен по умолчанию для квоты на уровне проекта не приведет к распространению этого значения на существующие пространства имен в проекте; обновленное значение будет применяться только к вновь созданным пространствам имен в этом проекте. Чтобы обновить ограничение пространства имен по умолчанию для существующих пространств имен, вы можете удалить и впоследствии воссоздать квоту на уровне проекта с новым значением по умолчанию. Это приведет к тому, что новое значение по умолчанию будет применено ко всем существующим пространствам имен в проекте.
Перед созданием пространства имен в проекте,  Rancher сравнивает количество доступных и запрошенных ресурсов, независимо от того, исходят ли они из ограничений по умолчанию или переопределенны. Если запрошенные ресурсы превышают оставшуюся емкость проекта для этих ресурсов, Rancher присвоит пространству имен оставшуюся емкость для этого ресурса.
 Однако это не относится к пространствам имен, созданным вне пользовательского интерфейса Rancher. Для пространств имен, созданных с помощью kubectl, Rancher назначит квоту ресурсов с **нулевым** значением для любого ресурса, запросившего больше емкости, чем осталось в проекте.
Чтобы создать пространство имен в существующем проекте с помощью kubectl, используйте примечание field.cattle.io/projectId. Чтобы переопределить запрошенное ограничение квоты по умолчанию, используйте  field.cattle.io/resourceQuota.

```
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    field.cattle.io/projectId: [your-cluster-ID]:[your-project-ID]
    field.cattle.io/resourceQuota: '{"limit":{"limitsCpu":"100m", "limitsMemory":"100Mi", "configMaps": "50"}}'
  name: my-ns
```

В следующей таблице поясняются основные различия между двумя типами квот.

|Квоты на ресурсы Rancher	|Квоты ресурсов Kubernetes|
|:-|:-|
|Применяется к проектам и пространствам имен.	|Применяется только к пространствам имен.|
|Создает пул ресурсов для всех пространств имен в проекте.|	Применяет ограничения статических ресурсов к отдельным пространствам имен.|
|Применяет квоты ресурсов к пространствам имен посредством распространения.	|Применяется только к назначенному пространству имен.|
