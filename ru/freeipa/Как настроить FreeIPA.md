


|**Название**|**Вес**|
| :- | :- |
|<p>[Configuring FreeIPA](https://github.com/rancher/docs/blob/master/content/rancher/v2.6/en/admin-settings/authentication/freeipa/_index.md) </p><p>Как настроить FreeIPA[^1]</p>|1114|

Если ваша организация использует FreeIPA для аутентификации пользователей, вы можете настроить Rancher так, чтобы ваши пользователи могли входить в систему, используя свои учетные данные FreeIPA.

***Предварительные требования:***

- *У вас должен быть настроен [сервер FreeIPA](https://www.freeipa.org/).*
- ` `*Создайте учетную запись сервиса в FreeIPA с доступом только для чтения (read-only). Rancher использует эту учетную запись для проверки членства в группе, когда пользователь делает запрос с использованием ключа API.*
- *Прочтите раздел "Внешняя настройка аутентификации и пользователи-принципалы (principal user)".*

1. Войдите в Rancher, используя локального пользователя, которому назначена роль администратора - administrator, т.е. локального принципала (local principal).
1. В левом верхнем углу нажмите **☰> Users & Authentication** (Пользователи и аутентификация).
1. В левом навигационном меню выберите **Auth Provider** (поставщик аутентификации).
1. Нажмите **FreeIPA**.
1. Заполните форму **Configure an FreeIPA server** (настройка сервера FreeIPA).

Возможно, вам потребуется войти в свой контроллер домена (domain controller), чтобы найти информацию, запрошенную в форме.

***Использование TLS?** Если сертификат является самоподписанным (self-signed) или получен не от общепризнанного центра сертификации, убедитесь, что вы предоставили полную цепочку. Эта цепочка необходима для проверки сертификата сервера.*

***База поиска пользователя (User Search Base) vs. база поиска группы (Group Search Base)***

` `*База поиска позволяет Rancher искать пользователей и группы, которые находятся в вашем FreeIPA. Эти поля предназначены только для баз поиска (search base), а не для поисковых фильтров (search filter).*

- *Если ваши пользователи и группы находятся в одной базе поиска, заполните только базу поиска пользователей (User Search Base).*
- *Если ваши группы находятся в другой базе поиска, вы можете дополнительно заполнить базу поиска группы (Group Search Base). Это поле предназначено для поиска групп, но не является обязательным.*

1. Если ваш FreeIPA отличается от стандартной схемы AD, заполните форму **Customize Schema** (настройка схемы), чтобы соответствовать ей. В противном случае пропустите этот шаг.

**Атрибут поиска.** Поле Search Attribute (атрибут поиска) по умолчанию содержит три специальных значения: uid|sn|givenName. Когда после настройки FreeIPA пользователь вводит текст для добавления пользователей или групп, Rancher автоматически запрашивает сервер FreeIPA и пытается сопоставить поля по фамилии, имени или идентификатору пользователя. Rancher специально ищет пользователей/группы, которые начинаются с текста, введенного в поле поиска.

По умолчанию значение этого поля равно uid|sn|givenName, но вы можете настроить это поле как подмножество этих элементов. Чтобы разделить эти значения можно использовать символ канала (|).

- uid: идентификатор пользователя,
- sn: фамилия,
- givenName: имя.

С помощью этого атрибута поиска Rancher создает фильтры поиска для пользователей и групп, но вы *не можете* добавить свои собственные фильтры поиска в это поле.

1. Введите свое имя пользователя и пароль FreeIPA в разделе **Authenticate with FreeIPA** (прохождение аутентификации с помощью FreeIPA), чтобы подтвердить, что Rancher настроен на использование аутентификации FreeIPA.
1. Нажмите **Enable** (включить).

**Результат:**

- Настроена аутентификация с помощью FreeIPA.
- Вы вошли в Rancher с помощью своей учетной записи FreeIPA (т.е. с помощью внешнего принципала).




[^1]: 